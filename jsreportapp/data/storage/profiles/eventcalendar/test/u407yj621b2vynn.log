{"type":"operationStart","subtype":"profile","data":{"_id":"Eyzjj6Aa3v3fmE9w","timestamp":"2023-01-26T15:29:52.373Z","state":"queued","mode":"standard","creationDate":"2023-01-26T15:29:52.374Z","modificationDate":"2023-01-26T15:29:52.374Z","shortid":"gf7v3l6","$entitySet":"profiles"},"doDiffs":false,"timestamp":1674746992374,"id":"33pqqdjuj20qxix","previousOperationId":null,"operationId":"tocfjv57gdj3wp8"}
{"type":"log","level":"info","message":"Render request 16 queued for execution and waiting for available worker","previousOperationId":"tocfjv57gdj3wp8","timestamp":1674746992374,"id":"ss0rpscchugulvc"}
{"type":"operationStart","subtype":"render","name":"test","previousOperationId":"tocfjv57gdj3wp8","timestamp":1674746992382,"id":"w80bfocg4julhqh","previousEventId":"33pqqdjuj20qxix","operationId":"balpdo3l8usno1q"}
{"type":"log","timestamp":1674746992382,"level":"info","message":"Starting rendering request 16","meta":{"rootId":"u407yj621b2vynn","id":"u407yj621b2vynn"},"id":"pyj47odkdi9xg71","previousOperationId":"balpdo3l8usno1q"}
{"type":"log","timestamp":1674746992382,"level":"info","message":"Rendering template { name: test, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"u407yj621b2vynn","id":"u407yj621b2vynn"},"id":"bffqha1g4th7nqd","previousOperationId":"balpdo3l8usno1q"}
{"type":"log","timestamp":1674746992383,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"u407yj621b2vynn","id":"u407yj621b2vynn"},"id":"2thlwxx020e7dgp","previousOperationId":"balpdo3l8usno1q"}
{"type":"log","timestamp":1674746992384,"level":"debug","message":"Executing script testing (beforeRender)","meta":{"rootId":"u407yj621b2vynn","id":"u407yj621b2vynn"},"id":"83w8t9fn5yxktn2","previousOperationId":"balpdo3l8usno1q"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1674746992443,"id":"jxnvg4jdddl0bme","previousEventId":"w80bfocg4julhqh","operationId":"4lz3lzf495ci23u","previousOperationId":"balpdo3l8usno1q"}
{"type":"operationStart","subtype":"script","name":"scripts testing","previousOperationId":"4lz3lzf495ci23u","timestamp":1674746992443,"id":"03qvnmbpf5p2z4z","previousEventId":"jxnvg4jdddl0bme","operationId":"36qgu6zal9t4evy"}
{"type":"log","timestamp":1674746992798,"level":"warn","message":"Error when processing render request 16\n(because) error when evaluating custom script /eventcalendar/testing\nCannot access 'sos' before initialization\n\n(sandbox.js line 19:12)\n\n  17 |   const sos = await axios.get(`http://localhost:3000/chart`).then(response => {\n  18 |     req.data.chart = { ...req.data,\n> 19 |         ...sos.data\n     |            ^\n  20 |     }\n  21 |     console.log(req.data.chart)\n  22 |     });\n\n(sandbox.js line 17:15)\n\n  15 |     }\n  16 |\n> 17 |   const sos = await axios.get(`http://localhost:3000/chart`).then(response => {\n     |               ^\n  18 |     req.data.chart = { ...req.data,\n  19 |         ...sos.data\n  20 |     }\n\n\nReferenceError: Cannot access 'sos' before initialization\n    at sandbox.js:19:12\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async Object.beforeRender (sandbox.js:17:15)\n    at async executionFn (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:184:24)\n    at async WorkerReporter._runInSandbox (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:180:14)\n    at async executeScript (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)\n    at async ListenerCollection.fire (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\listenerCollection.js:157:21)","meta":{"rootId":"u407yj621b2vynn","id":"u407yj621b2vynn"},"id":"pe9dmkpi6wv1wyc","previousOperationId":"36qgu6zal9t4evy"}
{"type":"log","timestamp":1674746992798,"level":"warn","message":"Rendering request 16 finished with error in 425 ms","meta":{"rootId":"u407yj621b2vynn","id":"u407yj621b2vynn"},"id":"ou213kb1y05ld5g","previousOperationId":"36qgu6zal9t4evy"}
{"type":"error","timestamp":1674746992804,"statusCode":400,"weak":true,"lineNumber":19,"decoratedSuffix":"\n\n(sandbox.js line 19:12)\n\n  17 |   const sos = await axios.get(`http://localhost:3000/chart`).then(response => {\n  18 |     req.data.chart = { ...req.data,\n> 19 |         ...sos.data\n     |            ^\n  20 |     }\n  21 |     console.log(req.data.chart)\n  22 |     });\n\n(sandbox.js line 17:15)\n\n  15 |     }\n  16 |\n> 17 |   const sos = await axios.get(`http://localhost:3000/chart`).then(response => {\n     |               ^\n  18 |     req.data.chart = { ...req.data,\n  19 |         ...sos.data\n  20 |     }\n\n","entity":{"shortid":"W0gvNctphZ","name":"testing","content":"// Use the \"beforeRender\" or \"afterRender\" hook\n// to manipulate and control the report generation\nconst axios = require('axios');\nconst nodemailer = require('nodemailer')\nvar id = 54;\n\n\n\nasync function beforeRender(req, res) {\n\n     \n    const r = await axios.get(`http://localhost:3000/events/54`)\n    req.data.events = { ...req.data,\n        ...r.data\n    }\n\n  const sos = await axios.get(`http://localhost:3000/chart`).then(response => {\n    req.data.chart = { ...req.data,\n        ...sos.data\n    }\n    console.log(req.data.chart)\n    });\n    \n\n\n\n    const s = await axios.get(`http://localhost:3000/events`)\n    req.data.events = { ...req.data,\n        ...s.data\n    }\n\n    const response = await axios.get('http://localhost:3000/locations')\n    req.data.locations = { ...req.data,\n        ...response.data\n    }\n\n    const responseEventType = await axios.get('http://localhost:3000/event_types')\n    req.data.eventType = { ...req.data,\n        ...responseEventType.data\n    }\n\n    // const responseUser = await axios.get('http://localhost:3000/users')    \n    // req.data.user = { ...req.data, ...responseUser.data}\n    // console.log(req.data.user)\n\n\n\n\n}\nlet chartData;\n\nasync function afterRender(req, res) {\n\n    const transporter = nodemailer.createTransport({\n        host: 'smtp.ethereal.email',\n        port: 587,\n        auth: {\n            user: 'isom26@ethereal.email',\n            pass: 'sQEWpaYJug5tattpkZ'\n        }\n    });\n\n  \n\n\n    await transporter.sendMail({\n        from: 'jdejohan@gmail.com',\n        to: \"isom26@ethereal.email\",\n        subject: 'CRUD report',\n        text: '...',\n        attachments: [{\n            filename: 'Data.pdf',\n            content: Buffer.from(res.content)\n        }],\n    })\n\n}\n"},"property":"content","logged":true,"previousOperationId":"36qgu6zal9t4evy","id":"e4pzq39gr8odq80","stack":"ReferenceError: Cannot access 'sos' before initialization\n    at sandbox.js:19:12\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async Object.beforeRender (sandbox.js:17:15)\n    at async executionFn (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:184:24)\n    at async WorkerReporter._runInSandbox (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:180:14)\n    at async executeScript (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)\n    at async ListenerCollection.fire (C:\\Users\\Johan\\Desktop\\clases\\Proyecto\\Calendar-Event\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\listenerCollection.js:157:21)","message":"Error when evaluating custom script /eventcalendar/testing\nCannot access 'sos' before initialization\n\n(sandbox.js line 19:12)\n\n  17 |   const sos = await axios.get(`http://localhost:3000/chart`).then(response => {\n  18 |     req.data.chart = { ...req.data,\n> 19 |         ...sos.data\n     |            ^\n  20 |     }\n  21 |     console.log(req.data.chart)\n  22 |     });\n\n(sandbox.js line 17:15)\n\n  15 |     }\n  16 |\n> 17 |   const sos = await axios.get(`http://localhost:3000/chart`).then(response => {\n     |               ^\n  18 |     req.data.chart = { ...req.data,\n  19 |         ...sos.data\n  20 |     }\n\n"}
